@model VmRepresentativeSalary
@{
    ViewData["Title"] = "ریز کارکرد نماینده";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <div class="card">
        <div class="card-header alert-secondary search-box">
            <h4 class="card-title">ریز کارکرد نماینده از خدمات توزیع بار</h4>
            <form asp-action="BranchSalary" asp-controller="AccRepresentative" asp-area="Accounting" method="get" id="frmBillFilter">
                <input type="hidden" asp-for="filter.FromBody" value="@true" />
                <div class="row">
                    <div class="col-md-4 col-12">
                        <label class="form-label">طرف حساب</label>
                        <select asp-for="filter.BranchId" class="form-select select2" asp-items="@ViewBag.BranchesList">
                        </select>
                    </div>
                    <div class="col-md-2 col-6">
                        <label class="form-label">از تاریخ</label>
                        <input type="text" asp-for="filter.StartDate" class="form-control flatpickr-input" />
                    </div>
                    <div class="col-md-2 col-6">
                        <label class="form-label">تا تاریخ</label>
                        <input type="text" asp-for="filter.UntilDate" class="form-control flatpickr-input" />
                    </div>

                    <div class="col-md-2 d-grid p-2 mt-3">
                        <input type="submit" class="btn btn-danger" value="نمایش" />
                    </div>
                </div>
            </form>
        </div>
        <div class="row cards-info alert-light mb-2">
            <div class="col-md-3 grid">
                <div class="card-info">
                    <p>تعداد بارنامه ها</p>
                    <h5> @Model.ReposrtDetails?.Count() </h5>
                    <small>بارنامه</small>
                </div>
            </div>
            <div class="col-md-3 grid">
                <div class="card-info">
                    <p>سهم نماینده از توزیع بارنامه ها</p>
                    <h5> @Model.ReposrtDetails?.Sum(n => n.DestributionShareAmount).ToPrice() </h5>
                    <small>ريال</small>
                </div>
            </div>
            <div class="col-md-3 grid">
                <div class="card-info">
                    <p>مبالغ دریافتی از پسکرایه</p>
                    <h5>  @Model.ReposrtDetails?.Sum(n => n.RepDebit).ToPrice()</h5>
                    <small>ريال</small>
                </div>
            </div>

            <div class="col-md-3 grid">
                <div class="card-info">
                    <p>مبلغ بدهکاری / بستانکاری نماینده</p>
                    <h5> @Model.ReposrtDetails?.Sum(n => n.DebBalance).ToPrice() </h5>
                    <small>ريال</small>
                </div>
            </div>
        </div>
    </div>

    <div class="card-body">
        <div class="table-responsive text-nowrap height-vh80">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>ردیف</th>
                        <th>شماره بارنامه</th>
                        <th>تاریخ بارنامه</th>
                        <th>مبلغ بارنامه</th>
                        <th>درصد نماینده</th>
                        <th>سهم نماینده</th>
                        <th>نوع تسویه</th>
                        <th style="width:120px;">بدهی دریافت پسکرایه</th>
                        <th>بد/بس نماینده</th>

                    </tr>
                </thead>
                <tbody>
                    @if (Model.ReposrtDetails != null && Model.ReposrtDetails.Any())
                    {
                        int rowNo = 1;
                        foreach (var x in Model.ReposrtDetails)
                        {
                            <tr>
                                <td class="text-center">@rowNo</td>
                                <td>@x.BillNumber</td>
                                <td>@x.BillDate.LatinToPersian()</td>
                                <td>@x.BillAmount.ToPrice()</td>
                                <td>@x.DestributionRate.ToString("0.#")</td>
                                <td>@x.DestributionShareAmount.ToPrice()</td>
                                <td>@x.SettelmentTypeName</td>
                                <td style="width:120px;">@x.RepDebit.ToPrice()</td>
                                <td>@x.DebBalance.ToPrice()</td>
                            </tr>
                            rowNo++;
                        }
                    }
                </tbody>
               @*  <tfoot>
                    <tr lass="table-secondary">
                        <td colspan="6"></td>
                        <td class="text-center"><strong>@Model.ReposrtDetails?.Sum(n => n.DestributionShareAmount).ToPrice()</strong></td>
                        <td></td>
                        <td class="text-center"><strong>@Model.ReposrtDetails?.Sum(n => n.RepDebit).ToPrice()</strong></td>
                        <td class="text-center"><strong>@Model.ReposrtDetails?.Sum(n => n.DebBalance).ToPrice()</strong></td>
                    </tr>
                </tfoot> *@
            </table>

        </div>
        <div class="card-footer alert-secondary">
        </div>
    </div>
</div>


