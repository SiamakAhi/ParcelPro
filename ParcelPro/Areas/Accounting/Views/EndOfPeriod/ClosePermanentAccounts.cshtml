@model EndOfPeriodDto
@{
    ViewData["Title"] = "CloseTemporaryAccounts";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="card card-primary">
    <h6 class="card-header">بستن حساب های دائم (ثبت سند اختتامیه)</h6>

    <div class="card-body">
        <dov class="row">
            <div class="col-md-3 p-3 alert-secondary box-radius pb-5">
                <div class="divider text-start divider-danger">
                    <div class="divider-text">
                        <span class="text-primary">تنظیم حساب ها</span>
                    </div>
                </div>

                <div>
                    <form asp-action="ClosePermanentAccountsPreview" asp-controller="EndOfPeriod" asp-area="Accounting" method="post">
                        <div class="row">
                           
                            <div class="col-md-12 mb-2">
                                <label>حساب تراز اختتامیه</label>
                                <select asp-for="AccountsSetting.EkhtetamiyeAccountId" class="select2 form-select" asp-items="@ViewBag.AllAccounts">
                                    <option value="null" selected>انتخاب کنید ...</option>
                                </select>
                            </div>
                            <hr />

                            <div class="col-md-12 d-grid mt-2 mb-3 px-4">
                                <input type="submit" class="btn btn-primary mb-2" value="پیش نمایش سند اختتامیه " />
                                <input type="button" class="btn btn-success mb-2 submitCustomAction" data-url="@Url.Action("AddDocClosePermanentAccounts","EndOfPeriod",new{Area="Accounting"})" value="ثبت سند اختامیه" />
                            </div>
                        </div>
                    </form>
                </div>

            </div>
            <div class="col-md-9 p-3">
                <div class="divider text-start divider-danger">
                    <div class="divider-text">
                        <span class="text-primary">پیش نمایش سند اختتامیـه</span>
                    </div>
                </div>

                <div class="table-responsive text-nowrap">
                    <table class="table table-bordered">
                        <thead class="table-dark">
                            <tr>
                                <th class="row-chb">ردیف</th>
                                <th class="limit-text">
                                    حساب
                                </th>
                                <th>
                                    شرح آرتیکل
                                </th>
                                <th>بدهکار</th>
                                <th>بستانکار</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model.Articles?.Count > 0)
                            {
                                int rownumber = 1;
                                foreach (var x in Model.Articles)
                                {
                                    <tr id="@x.Id" data-deb="@x.Bed" data-bes="@x.Bes" class="dblc_callform @(x.IsMatch==false ?" bg-danger text-white":"")">
                                        <td class="row-chb">@rownumber</td>
                                        <td>
                                            <span class="text-secondary">@x.MoeinCode</span>
                                            <span class="me-2">@x.MoeinName</span>
                                        </td>
                                        <td class="limit-text" title="@x.Comment">

                                            @x.Comment
                                        </td>
                                        <td>
                                            <span>@(x.Bed > 0 ? x.Bed.ToPrice() : "0")</span>
                                        </td>
                                        <td>
                                            <span>@(x.Bes > 0 ? x.Bes.ToPrice() : "0")</span>
                                        </td>

                                    </tr>
                                    rownumber++;
                                }
                            }

                        </tbody>
                        <tfoot>
                            @if (Model.Articles?.Count > 0)
                            {
                                <tr>
                                    <td colspan="3" class="text-center"> <h5>جمع :</h5></td>
                                    <td class="text-center">@Model.Articles.Sum(n=>n.Bed)</td>
                                    <td class="text-center">@Model.Articles.Sum(n=>n.Bes)</td>
                                </tr>
                            }
                        </tfoot>
                    </table>
                </div>

            </div>
        </dov>
    </div>
</div>

